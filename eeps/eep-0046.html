<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Allow pinning of website on windows -->
    <meta name="application-name" content="Erlang.org">
    <meta name="msapplication-tooltip" content="The official home of the Erlang Programming Language">
    <meta name="msapplication-starturl" content="/" >

    <!-- Make the site look nicer on facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Erlang.org">
    <meta property="og:title" content="Welcome to Erlang.org">
    <meta property="og:description" content="The official home of the Erlang Programming Language">
    <meta property="og:image" content="https://beta.erlang.org/assets/img/erlang-228x200.png">
    <meta property="og:image:secure_url" content="https://beta.erlang.org/assets/img/erlang-228x200.png">
    <meta property="og:url" content="https://beta.erlang.org/">

    <!-- Twitter metadata -->
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Index" />
    <meta name="twitter:site" content="@erlang_org" />

    <!-- Rich data for google search -->
    <script type="application/ld+json">
{"@type":"WebSite","url":"https://erlang.org/","headline":"Eep 0046 - Erlang/OTP","name":"Erlang.org","sameAs":["https://twitter.com/erlang_org","https://github.com/erlang/otp"],"@context":"https://schema.org"}</script>

    <title>Eep 0046 - Erlang/OTP</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- tells iOS browsers to not show telephone numbers as links -->
    <meta name="format-detection" content="telephone=no">

    <meta name="application-name" content="Erlang.org">
    <meta name="description" content="The official home of the Erlang Programming Language">
    <meta name="keywords" content="Erlang programming language functional parallel distributed documentation download community">
    <!-- https://www.rssboard.org/rss-autodiscovery -->
    <link rel="alternate" type="application/atom+xml" title="News Atom Feed" href="https://beta.erlang.org/news.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Atom Feed" href="https://beta.erlang.org/blog.xml" />
    
    <link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>
    <header class="navbar navbar-expand-lg navbar-light bg-body">
        <nav class="container">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/"><img
                    src="/assets/img/erlang.png" class="img-fluid" width="60" alt="Erlang.org main page"/></a>
            <div class="collapse navbar-collapse fw-bold" id="navbarSupportedContent">
                <ul class="navbar-nav text-uppercase me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="/downloads">Download</a></li>
                    <li class="nav-item"><a class="nav-link" href="/docs">Documentation</a></li>
                    <li class="nav-item"><a class="nav-link" href="/community">Community</a></li>
                    <li class="nav-item"><a class="nav-link" href="/news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="/blog">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="/eep">EEP</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
                </ul>
                <form class="d-flex" role="search" method="get" action="https://duckduckgo.com/">
                    <input type="hidden" name="sites" value="erlang.org">
                    <input class="form-control me-2" id="searchfield" name="q" type="search" placeholder="Search erlang.org"
                        aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
            </div>
        </nav>
    </header>
    <div class="container border-top pt-4">
    <div class="row-lg">
        <div class="col-lg-10 offset-lg-1">
            <div class="card">
                <div class="card-body">
                    <dl class="mb-0 dl-single">
                        <dt>Author:</dt>
                        <dd>
                            Walter Weinmann &lt;walter.weinmann@gmail.com&gt;
                            
                            
                        </dd>
                        
                        <dt>Status:</dt>
                        <dd>Draft </dd>
                        <dt>Type:</dt>
                        <dd>Standards Track</dd>
                        
                        
                        <dt>Created:</dt>
                        <dd>06-Dec-2016</dd>
                        
                        <dt>Erlang-Version:</dt>
                        <dd>OTP 20.0</dd>
                        
                        
                        <dt>Post-History:</dt>
                        <dd>6-Dec-2016</dd>
                        
                        
                        
                    </dl>
                </div>
            </div>
            <div class="border-top mt-4">
                
                <h2  id="eep-46-b-trees-balanced-search-trees-of-order-n">
        
        
          EEP 46: B-trees: balanced search trees of order n <a href="#eep-46-b-trees-balanced-search-trees-of-order-n">#</a>
        
        
      </h2>
    
      <h1  id="abstract">
        
        
          Abstract <a href="#abstract">#</a>
        
        
      </h1>
    
<p>This EEP proposes the creation of a new module named b_trees for the
administration of b-trees.  Both the optional persistence and the sort
order should be implemented by pluggable functionality.</p>
      <h1  id="copyright">
        
        
          Copyright <a href="#copyright">#</a>
        
        
      </h1>
    
<p>This document has been placed in the public domain.</p>
      <h1  id="specification">
        
        
          Specification <a href="#specification">#</a>
        
        
      </h1>
    
      <h2  id="data-structure">
        
        
          Data Structure <a href="#data-structure">#</a>
        
        
      </h2>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">{</span><span class="nv">MinimumSubtrees</span><span class="p">,</span> 
 <span class="nv">MaximumKeys</span><span class="p">,</span> 
 <span class="nv">SizeKeyValues</span><span class="p">,</span> 
 <span class="nv">SortFunction</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
 <span class="nv">State</span><span class="p">,</span> 
 <span class="nv">Tree</span><span class="p">}</span>
</code></pre></div></div>
<p><code>Tree</code> is composed of nodes of the form</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">{</span><span class="nv">KeyNumber</span><span class="p">,</span> 
 <span class="nv">SubtreeNumber</span><span class="p">,</span> 
 <span class="p">[{</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}],</span> 
 <span class="p">[</span><span class="nv">Tree</span><span class="p">]}</span> 
</code></pre></div></div>
<p>and the “empty b-tree” node</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="n">nil</span>
</code></pre></div></div>
<p><code>State</code> is a tuple composed of the following parameters:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">{</span><span class="nv">StateTarget</span><span class="p">,</span> 
 <span class="nv">DeleteFunction</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> 
 <span class="nv">InsertFunction</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> 
 <span class="nv">LookupFunction</span><span class="o">/</span><span class="mi">3</span><span class="p">}</span> 
</code></pre></div></div>
<p>Since the b-trees are always balanced, there is no need for a balance
operation.</p>
      <h2  id="data-types">
        
        
          DATA TYPES <a href="#data-types">#</a>
        
        
      </h2>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nf">b_tree</span><span class="p">()</span> <span class="o">=</span> <span class="p">{</span><span class="nf">pos_integer</span><span class="p">(),</span> 
            <span class="nf">pos_integer</span><span class="p">(),</span> 
            <span class="nf">non_neg_integer</span><span class="p">(),</span> 
            <span class="nf">sort_function</span><span class="p">(),</span> 
            <span class="nf">state</span><span class="p">(),</span> 
            <span class="nf">tree</span><span class="p">()}</span>
</code></pre></div></div>
<p>A general balanced tree.</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nf">iterator</span><span class="p">()</span> <span class="o">=</span> <span class="p">[{</span><span class="nf">key_values</span><span class="p">(),</span> <span class="nf">subtrees</span><span class="p">()}]</span>
</code></pre></div></div>
<p>A general balanced tree iterator.</p>
      <h2  id="exports">
        
        
          EXPORTS <a href="#exports">#</a>
        
        
      </h2>
    
      <h3  id="copy-tree1-tree2-gt-tree3">
        
        
          copy(Tree1, Tree2) -&gt; Tree3 <a href="#copy-tree1-tree2-gt-tree3">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">Tree2</span> <span class="o">=</span> <span class="nv">Tree3</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span> <span class="p">|</span> <span class="nn">gb_trees</span><span class="p">:</span><span class="nf">tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Copies tree Tree1 to an empty tree Tree2. Both trees may be either
of type b-tree or binary tree (gb_trees). Returns the new tree
Tree3 of the same type as tree Tree2.</p>
      <h3  id="delete-key-b-tree1-gt-b-tree2">
        
        
          delete(Key, B-Tree1) -&gt; B-Tree2 <a href="#delete-key-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Removes the node with key Key from b-tree B-Tree1 and returns the new
b-tree B-Tree2.  Assumes that key Key is present in b-tree B-Tree1,
crashes otherwise.</p>
      <h3  id="delete-any-key-b-tree1-gt-b-tree2">
        
        
          delete_any (Key, B-Tree1) -&gt; B-Tree2 <a href="#delete-any-key-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Removes the node with key Key from b-tree B-Tree1 if key Key is present
in b-tree B-Tree1, otherwise does nothing.  Returns the new b-tree B-Tree2.</p>
      <h3  id="empty-order-gt-b-tree">
        
        
          empty (Order) -&gt; B-Tree <a href="#empty-order-gt-b-tree">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Order</span> <span class="o">=</span> <span class="nf">pos_integer</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns a new empty b-tree.  The order is defined as the maximum number
of children nodes a non-leaf node may hold.</p>
      <h3  id="enter-key-value-b-tree1-gt-b-tree2">
        
        
          enter (Key, Value, B-Tree1) -&gt; B-Tree2 <a href="#enter-key-value-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Inserts key Key with value Value into b-tree B-Tree1 if key Key is not
present in b-tree B-Tree1, otherwise updates the current value of key Key
to value Value in b-tree B-Tree1.  Returns a new b-tree B-Tree2.</p>
      <h3  id="from-dict-b-tree1-list-gt-b-tree2">
        
        
          from_dict (B-Tree1, List) -&gt; B-Tree2 <a href="#from-dict-b-tree1-list-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">List</span> <span class="o">=</span> <span class="p">[{</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}]</span>
</code></pre></div></div>
<p>Turns an ordered list List of key value tuples into a b-tree.  The given
b-tree B-Tree1 must be empty.  The list must not contain duplicate keys.</p>
      <h3  id="get-key-b-tree-gt-value">
        
        
          get (Key, B-Tree) -&gt; Value <a href="#get-key-b-tree-gt-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Retrieves the value stored with key Key in b-tree B-Tree.  Assumes that
key Key is present in b-tree B-Tree, crashes otherwise.</p>
      <h3  id="height-b-tree-gt-integer-gt-0">
        
        
          height (B-Tree) -&gt; integer() &gt;= 0 <a href="#height-b-tree-gt-integer-gt-0">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the height of b-tree B-Tree as an integer.  Assumes that b-tree
B-Tree is non-empty.</p>
      <h3  id="insert-key-value-b-tree1-gt-b-tree2">
        
        
          insert (Key, Value, B-Tree1) -&gt; B-Tree2 <a href="#insert-key-value-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Inserts key Key with value Value into b-tree  B-Tree1 and returns the new
b-tree B-Tree2.  Assumes that key Key is <strong>not</strong> present in b-tree B-Tree1,
crashes otherwise.</p>
      <h3  id="is-defined-key-b-tree-gt-boolean">
        
        
          is_defined (Key, B-Tree) -&gt; boolean() <a href="#is-defined-key-b-tree-gt-boolean">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns <code>true</code> if key Key is present in b-tree B-Tree, otherwise <code>false</code>.</p>
      <h3  id="is-empty-b-tree-gt-boolean">
        
        
          is_empty (B-Tree) -&gt; boolean() <a href="#is-empty-b-tree-gt-boolean">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns <code>true</code> if b-tree B-Tree is an empty b-tree, otherwise <code>false</code>.</p>
      <h3  id="iterator-b-tree-gt-iterator">
        
        
          iterator (B-Tree) -&gt; Iterator <a href="#iterator-b-tree-gt-iterator">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Iterator</span> <span class="o">=</span> <span class="nf">iterator</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns iterator Iterator that can be used for traversing the entries
of b-tree B-Tree; see <code>next/1</code>.  The implementation of this iterator is
very efficient; traversing the whole b-tree using <code>next/1</code> is only slightly
slower than getting the list of all key-value pairs using <code>to_list/1</code>
and traversing that.  The main advantage of the iterator approach is that
it does not require the complete list of all key-value pairs to be built
in memory at one time.</p>
      <h3  id="iterator-from-key-b-tree-gt-iterator">
        
        
          iterator_from (Key, B-Tree) -&gt; Iterator <a href="#iterator-from-key-b-tree-gt-iterator">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">(</span><span class="mi">9</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Iterator</span> <span class="o">=</span> <span class="nf">iterator</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns iterator Iterator that can be used for traversing the entries
of b-tree B-Tree; see <code>next/1</code>.  The difference, as compared to the
iterator returned by iterator/1, is that the first key greater than
or equal to key Key is returned.</p>
      <h3  id="keys-b-tree-gt-key">
        
        
          keys (B-Tree) -&gt; [Key] <a href="#keys-b-tree-gt-key">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the keys in b-tree B-Tree as an ordered list.</p>
      <h3  id="largest-b-tree-gt-key-value">
        
        
          largest (B-Tree) -&gt; {Key, Value} <a href="#largest-b-tree-gt-key-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns a tuple {Key, Value}, where Key is the largest key in b-tree
B-Tree, and Value is the value associated with this key.  Assumes that
b-tree B-Tree is not empty.</p>
      <h3  id="lookup-key-b-tree-gt-none-value-value">
        
        
          lookup (Key, B-Tree) -&gt; none | {value, Value} <a href="#lookup-key-b-tree-gt-none-value-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Looks up key Key in b-tree B-Tree. Returns {value, Value}, or none if
key Key is not present.</p>
      <h3  id="map-function-b-tree1-gt-b-tree2">
        
        
          map (Function, B-Tree1) -&gt; B-Tree2 <a href="#map-function-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Function</span> <span class="o">=</span> <span class="k">fun</span><span class="p">((</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">Value2</span><span class="p">)</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value1</span> <span class="o">=</span> <span class="nv">Value2</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Maps function Function(Key, Value1) -&gt; Value2 to all key value pairs of
b-tree B-Tree1.  Returns the new b-tree B-Tree2 with the same set of
keys as b-tree B-Tree1 and the new set of values.</p>
      <h3  id="next-iterator1-gt-none-key-value-iterator2">
        
        
          next (Iterator1) -&gt; ‘none’ | {Key, Value, Iterator2} <a href="#next-iterator1-gt-none-key-value-iterator2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Iterator1</span> <span class="o">=</span> <span class="nv">Iterator2</span> <span class="o">=</span> <span class="nf">iterator</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the tuple {Key, Value, Iterator2}, where Key is the smallest
key referred to by iterator Iterator1, and iterator Iterator2 is the
new iterator to be used for traversing the remaining nodes, or the
atom ‘<strong>none</strong>’ if no nodes remain.</p>
      <h3  id="set-parameter-b-tree1-name-value-gt-b-tree2">
        
        
          set_parameter (B-Tree1, Name, Value) -&gt; B-Tree2 <a href="#set-parameter-b-tree1-name-value-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Name</span> <span class="p">:</span> <span class="nv">Value</span> <span class="o">=</span> <span class="n">sort</span>  <span class="p">:</span> <span class="nv">Function</span> <span class="o">=</span> <span class="k">fun</span><span class="p">((</span><span class="nv">Key1</span><span class="p">,</span> <span class="nv">Key2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">equal</span> <span class="p">|</span> 
                                                      <span class="n">greater</span> <span class="p">|</span> 
                                                      <span class="n">less</span><span class="p">)</span>
             <span class="p">|</span> <span class="n">state</span> <span class="p">:</span> <span class="p">{</span><span class="nv">StateTarget</span><span class="p">,</span> 
                        <span class="nv">Function</span> <span class="o">=</span> <span class="k">fun</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="nv">Key</span><span class="p">)</span> 
                                 <span class="o">-&gt;</span> <span class="n">true</span><span class="p">,</span>
                        <span class="nv">Function</span> <span class="o">=</span> <span class="k">fun</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">insert</span><span class="p">,</span> <span class="nv">Subtrees</span><span class="p">)</span> 
                                 <span class="o">-&gt;</span> <span class="nv">Key</span><span class="p">,</span>
                        <span class="nv">Function</span> <span class="o">=</span> <span class="k">fun</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">lookup</span><span class="p">,</span> <span class="nv">Key</span><span class="p">)</span> 
                                 <span class="o">-&gt;</span> <span class="nv">Subtrees</span><span class="p">}</span>
</code></pre></div></div>
<p>Sets the parameter Name to value Value in the empty b-tree B-Tree1 and
returns the new b-tree B-Tree2.  This function can only be used in
conjunction with an empty b-tree.</p>
      <h3  id="size-key-values-b-tree-gt-integer-gt-0">
        
        
          size_key_values (B-Tree) -&gt; integer() &gt;= 0 <a href="#size-key-values-b-tree-gt-integer-gt-0">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the number of key value pairs in b-tree B-Tree as an integer.<br />
Returns 0 (zero) if b-tree B-Tree is empty.</p>
      <h3  id="size-nodes-b-tree-gt-integer-gt-0-integer-gt-0">
        
        
          size_nodes (B-Tree) -&gt; {integer() &gt;= 0, integer() &gt;= 0} <a href="#size-nodes-b-tree-gt-integer-gt-0-integer-gt-0">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the number of total nodes and the number of leaf nodes in b-tree
B-Tree as a tuple of two integers.  Returns {0, 0} (zero) if b-tree B-Tree
is empty.</p>
      <h3  id="smallest-b-tree-gt-key-value">
        
        
          smallest (B-Tree) -&gt; {Key, Value} <a href="#smallest-b-tree-gt-key-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns tuple {Key, Value}, where Key is the smallest key in b-tree
B-Tree, and Value is the value associated with this key.  Assumes that
b-tree B-Tree is not empty.</p>
      <h3  id="sort-ascending-key1-key2-gt-equal-greater-less">
        
        
          sort_ascending (Key1, Key2) -&gt; ‘equal’ | ‘greater’ | ‘less’ <a href="#sort-ascending-key1-key2-gt-equal-greater-less">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key1</span> <span class="o">=</span> <span class="nv">Key2</span>  <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="n">equal</span> <span class="o">=</span> <span class="n">greater</span> <span class="o">=</span> <span class="n">less</span> <span class="o">=</span> <span class="nf">atom</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the atom ‘<strong>greater</strong>’ if Key1 &gt; Key2, the atom ‘<strong>less</strong>’
if Key1 &lt; Key2 and otherwise the atom ‘<strong>equal</strong>’.</p>
      <h3  id="sort-descending-key1-key2-gt-equal-greater-less">
        
        
          sort_descending (Key1, Key2) -&gt; ‘equal’ | ‘greater’ | ‘less’ <a href="#sort-descending-key1-key2-gt-equal-greater-less">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key1</span> <span class="o">=</span> <span class="nv">Key2</span>  <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="n">equal</span> <span class="o">=</span> <span class="n">greater</span> <span class="o">=</span> <span class="n">less</span> <span class="o">=</span> <span class="nf">atom</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the atom ‘<strong>less</strong>’ if Key1 &gt; Key2, the atom ‘<strong>greater</strong>’
if Key1 &lt; Key2 and otherwise the atom ‘<strong>equal</strong>’.</p>
      <h3  id="take-key-b-tree1-gt-b-tree2">
        
        
          take(Key, B-Tree1) -&gt; B-Tree2 <a href="#take-key-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Removes the node with key Key from b-tree B-Tree1 and returns the new
b-tree B-Tree2.  Assumes that key Key is present in b-tree B-Tree1,
crashes otherwise.</p>
      <h3  id="delete-any-key-b-tree1-gt-b-tree2">
        
        
          delete_any (Key, B-Tree1) -&gt; B-Tree2 <a href="#delete-any-key-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Removes the node with key Key from b-tree B-Tree1 if key Key is present
in b-tree B-Tree1, otherwise does nothing. Returns the new b-tree B-Tree2.</p>
      <h3  id="take-largest-b-tree1-gt-key-value-b-tree2">
        
        
          take_largest (B-Tree1) -&gt; {Key, Value, B-Tree2} <a href="#take-largest-b-tree1-gt-key-value-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns tuple {Key, Value, B-Tree2}, where Key is the largest key in
b-tree B-Tree1, Value is the value associated with this key, and b-tree
B-Tree2 is this b-tree with the corresponding key value pair deleted.<br />
Assumes that b-tree B-Tree1 is not empty.</p>
      <h3  id="take-smallest-b-tree1-gt-key-value-b-tree2">
        
        
          take_smallest (B-Tree1) -&gt; {Key, Value, B-Tree2} <a href="#take-smallest-b-tree1-gt-key-value-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns tuple {Key, Value, B-Tree2}, where Key is the smallest key in
b-tree B-Tree1, Value is the value associated with this key, and b-tree
B-Tree2 is this b-tree with the corresponding key value pair deleted.<br />
Assumes that b-tree B-Tree1 is not empty.</p>
      <h3  id="to-list-b-tree-gt-key-value">
        
        
          to_list (B-Tree) -&gt; [{Key, Value}] <a href="#to-list-b-tree-gt-key-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Converts b-tree B-Tree into an ordered list of key value tuples.</p>
      <h3  id="update-key-value-b-tree1-gt-b-tree2">
        
        
          update (Key, Value, B-Tree1) -&gt; B-Tree2 <a href="#update-key-value-b-tree1-gt-b-tree2">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">Key</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
<span class="nv">B</span><span class="o">-</span><span class="nv">Tree1</span> <span class="o">=</span> <span class="nv">B</span><span class="o">-</span><span class="nv">Tree2</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
</code></pre></div></div>
<p>Updates key Key to value Value in b-tree B-Tree1 and returns the new
b-tree B-Tree2.  Assumes that key Key is present in b-tree B-Tree1.</p>
      <h3  id="values-b-tree-gt-value">
        
        
          values (B-Tree) -&gt; [Value] <a href="#values-b-tree-gt-value">#</a>
        
        
      </h3>
    
<p>Types:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">B</span><span class="o">-</span><span class="nv">Tree</span> <span class="o">=</span> <span class="nf">b_tree</span><span class="p">()</span>
<span class="nv">Value</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>Returns the values in b-tree B-Tree as an ordered list, sorted by their
corresponding keys.  Duplicates are not removed.</p>
      <h2  id="pluggable-persistence-functionality">
        
        
          Pluggable Persistence Functionality <a href="#pluggable-persistence-functionality">#</a>
        
        
      </h2>
    
      <h3  id="format">
        
        
          Format: <a href="#format">#</a>
        
        
      </h3>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">{</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="nv">DeleteFunction</span><span class="p">,</span> <span class="nv">InsertFunction</span><span class="p">,</span> <span class="nv">LookupFunction</span><span class="p">}</span>

<span class="nv">StateTarget</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>

<span class="nv">DeleteFunction</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="nv">Key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">true</span>

<span class="nv">InsertFunction</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">insert</span><span class="p">,</span> <span class="nv">Subtrees</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">Key</span>

<span class="nv">LookupFunction</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">lookup</span><span class="p">,</span> <span class="nv">Key</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">Subtrees</span>
</code></pre></div></div>
<p>Examples for state targets are a Dets table or a Mnesia table.  The delete
function takes a state target, the atom <code>delete</code> and a key as arguments
and returns the atom <code>true</code> if successful.  The insert function takes a
state target, the atom <code>insert</code> and a subtrees data structure as arguments
and returns a key if successful.  The lookup function takes a state target,
the atom <code>lookup</code> and a key as arguments and returns a subtrees data
structure if successful.</p>
      <h3  id="example-functions">
        
        
          Example functions: <a href="#example-functions">#</a>
        
        
      </h3>
    
<p>The following examples are based on Mnesia.</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nf">persistence_by_mnesia</span><span class="p">(_,</span> <span class="n">delete</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">)</span> 
                     <span class="k">when</span> <span class="nb">is_list</span><span class="p">(</span><span class="nv">SubtreesKey</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="n">true</span><span class="p">;</span>
<span class="nf">persistence_by_mnesia</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">delete</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">F</span> <span class="o">=</span> <span class="k">fun</span><span class="p">()</span> <span class="o">-&gt;</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="nn">mnesia</span><span class="p">:</span><span class="nf">delete</span><span class="p">({</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">}),</span>
        <span class="n">true</span>
    <span class="k">end</span><span class="p">,</span>
    <span class="nn">mnesia</span><span class="p">:</span><span class="nf">activity</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="nv">F</span><span class="p">);</span>
    
<span class="nf">persistence_by_mnesia</span><span class="p">(_,</span> <span class="n">insert</span><span class="p">,</span> <span class="p">[])</span> <span class="o">-&gt;</span>
    <span class="p">[];</span>
<span class="nf">persistence_by_mnesia</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">insert</span><span class="p">,</span> 
                      <span class="p">[{_,</span> <span class="p">_,</span> <span class="p">[{</span><span class="nv">Key</span><span class="p">,</span> <span class="p">_}</span> <span class="p">|</span> <span class="p">_],</span> <span class="p">_}</span> <span class="p">|</span> <span class="p">_]</span> <span class="o">=</span> <span class="nv">Subtrees</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">SubtreesKey</span> <span class="o">=</span> <span class="nb">list_to_binary</span><span class="p">(</span><span class="nv">Key</span><span class="p">),</span>
    <span class="nv">F</span> <span class="o">=</span> <span class="k">fun</span><span class="p">()</span> <span class="o">-&gt;</span>
        <span class="n">ok</span> <span class="o">=</span> <span class="nn">mnesia</span><span class="p">:</span><span class="nf">write</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> 
                          <span class="nl">#subtrees</span><span class="p">{</span><span class="n">subtreesKey</span> <span class="o">=</span> <span class="nv">SubtreesKey</span><span class="p">,</span> 
                          <span class="n">subtrees</span> <span class="o">=</span> <span class="nv">Subtrees</span><span class="p">},</span> <span class="n">write</span><span class="p">),</span>
        <span class="nv">SubtreesKey</span>
    <span class="k">end</span><span class="p">,</span>
    <span class="nn">mnesia</span><span class="p">:</span><span class="nf">activity</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="nv">F</span><span class="p">);</span>
    
<span class="nf">persistence_by_mnesia</span><span class="p">(_,</span> <span class="n">lookup</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">)</span> 
                     <span class="k">when</span> <span class="nb">is_list</span><span class="p">(</span><span class="nv">SubtreesKey</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">SubtreesKey</span><span class="p">;</span>
<span class="nf">persistence_by_mnesia</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> <span class="n">lookup</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">F</span> <span class="o">=</span> <span class="k">fun</span><span class="p">()</span> <span class="o">-&gt;</span>
        <span class="p">[{</span><span class="n">subtrees</span><span class="p">,</span> <span class="nv">SubtreesKey</span><span class="p">,</span> <span class="nv">Subtrees</span><span class="p">}]</span> <span class="o">=</span> <span class="nn">mnesia</span><span class="p">:</span><span class="nf">read</span><span class="p">(</span><span class="nv">StateTarget</span><span class="p">,</span> 
                                                          <span class="nv">SubtreesKey</span><span class="p">),</span>
        <span class="nv">Subtrees</span>
    <span class="k">end</span><span class="p">,</span>
<span class="nn">mnesia</span><span class="p">:</span><span class="nf">activity</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="nv">F</span><span class="p">).</span>
</code></pre></div></div>
      <h3  id="example-usage">
        
        
          Example usage: <a href="#example-usage">#</a>
        
        
      </h3>
    
<p>Creating the Mnesia table:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">-</span><span class="ni">record</span><span class="p">(</span><span class="nl">subtrees</span><span class="p">,</span> <span class="p">{</span><span class="n">subtreesKey</span><span class="p">,</span> <span class="n">subtrees</span><span class="p">}).</span>
    
<span class="p">{</span><span class="n">atomic</span><span class="p">,</span> <span class="n">ok</span><span class="p">}</span> <span class="o">=</span> <span class="nn">mnesia</span><span class="p">:</span><span class="nf">create_table</span><span class="p">(</span><span class="nv">StateTargetName</span><span class="p">,</span> <span class="p">[{</span><span class="n">record_name</span><span class="p">,</span> 
                                                      <span class="n">subtrees</span><span class="p">}]),</span>
</code></pre></div></div>
<p>Creating the b-tree:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">BTree1</span> <span class="o">=</span> <span class="nn">b_trees</span><span class="p">:</span><span class="nf">empty</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span>
<span class="nv">BTree2</span> <span class="o">=</span> <span class="nn">b_trees</span><span class="p">:</span><span class="nf">set_parameter</span><span class="p">(</span><span class="nv">BTree1</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> 
                               <span class="p">{</span><span class="nv">StateTargetName</span><span class="p">,</span> 
                                <span class="k">fun</span> <span class="n">persistence_by_mnesia</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> 
                                <span class="k">fun</span> <span class="n">persistence_by_mnesia</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> 
                                <span class="k">fun</span> <span class="n">persistence_by_mnesia</span><span class="o">/</span><span class="mi">3</span><span class="p">}),</span>
</code></pre></div></div>
      <h2  id="pluggable-sort-functionality">
        
        
          Pluggable Sort Functionality <a href="#pluggable-sort-functionality">#</a>
        
        
      </h2>
    
      <h3  id="format">
        
        
          Format: <a href="#format">#</a>
        
        
      </h3>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">FunctionName</span><span class="p">(</span><span class="nv">Key1</span><span class="p">,</span> <span class="nv">Key2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">equal</span> <span class="p">|</span> <span class="n">greater</span> <span class="p">|</span> <span class="n">less</span>

<span class="nv">Key1</span> <span class="o">=</span> <span class="nv">Key2</span> <span class="o">=</span> <span class="nf">any</span><span class="p">()</span>
</code></pre></div></div>
<p>The sort function takes two keys as arguments and returns the atom <code>less</code>
if Key1 &lt; Key2, the atom <code>greater</code> if Key1 &gt; Key2 and otherwise the
atom <code>equal</code>.</p>
      <h3  id="example-function">
        
        
          Example function: <a href="#example-function">#</a>
        
        
      </h3>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="p">-</span><span class="ni">spec</span> <span class="nf">sort_descending</span><span class="p">(</span><span class="nf">key</span><span class="p">(),</span> <span class="nf">key</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="nf">sort_result</span><span class="p">().</span>

<span class="nf">sort_descending</span><span class="p">(</span><span class="nv">Key_1</span><span class="p">,</span> <span class="nv">Key_2</span><span class="p">)</span> <span class="o">-&gt;</span>
<span class="k">if</span>
    <span class="nv">Key_1</span> <span class="o">&lt;</span> <span class="nv">Key_2</span> <span class="o">-&gt;</span> <span class="n">greater</span><span class="p">;</span>
    <span class="nv">Key_1</span> <span class="o">&gt;</span> <span class="nv">Key_2</span> <span class="o">-&gt;</span> <span class="n">less</span><span class="p">;</span>
    <span class="n">true</span> <span class="o">-&gt;</span> <span class="n">equal</span>
<span class="k">end</span><span class="p">.</span>
</code></pre></div></div>
      <h3  id="example-usage">
        
        
          Example usage: <a href="#example-usage">#</a>
        
        
      </h3>
    
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nv">BTree1</span> <span class="o">=</span> <span class="nn">b_trees</span><span class="p">:</span><span class="nf">empty</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span>
<span class="nv">BTree2</span> <span class="o">=</span> <span class="nn">b_trees</span><span class="p">:</span><span class="nf">set_parameter</span><span class="p">(</span><span class="nv">BTree1</span><span class="p">,</span> <span class="n">sort</span><span class="p">,</span> <span class="k">fun</span> <span class="n">sort_descending</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
</code></pre></div></div>
      <h1  id="motivation">
        
        
          Motivation <a href="#motivation">#</a>
        
        
      </h1>
    
<p>B-trees are self-balancing tree data structures that keep data sorted
and allow searches, sequential access, insertions, and deletions in
logarithmic time.  B-trees are a generalization of a binary search
trees in that a node can have more than two children.  Unlike self-balancing
binary search trees, the b-tree is optimized for systems that read and
write large blocks of data.  B-trees are a good example of a data structure
for external memory.</p>
      <h1  id="rationale">
        
        
          Rationale <a href="#rationale">#</a>
        
        
      </h1>
    
<p>The functional design of the module b_trees is based on the module gb_trees:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"> <span class="n">b_trees</span>          <span class="p">|</span> <span class="n">gb_trees</span>
<span class="p">-</span><span class="err">-----------------|---------
 </span><span class="ni">n</span><span class="o">/</span><span class="n">a</span>              <span class="p">|</span> <span class="n">balance</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">copy</span><span class="o">/</span><span class="mi">2</span>           <span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">delete</span><span class="o">/</span><span class="mi">2</span>         <span class="p">|</span> <span class="n">delete</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">delete_any</span><span class="o">/</span><span class="mi">2</span>     <span class="p">|</span> <span class="n">delete_any</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">empty</span><span class="o">/</span><span class="mi">1</span>          <span class="p">|</span> <span class="n">empty</span><span class="o">/</span><span class="mi">0</span>
 <span class="n">enter</span><span class="o">/</span><span class="mi">3</span>          <span class="p">|</span> <span class="n">enter</span><span class="o">/</span><span class="mi">3</span>
 <span class="n">from_dict</span><span class="o">/</span><span class="mi">2</span>      <span class="p">|</span> <span class="n">from_orddict</span><span class="o">/</span><span class="mi">1</span>
 <span class="nb">get</span><span class="o">/</span><span class="mi">2</span>            <span class="p">|</span> <span class="nb">get</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">height</span><span class="o">/</span><span class="mi">1</span>         <span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">insert</span><span class="o">/</span><span class="mi">3</span>         <span class="p">|</span> <span class="n">insert</span><span class="o">/</span><span class="mi">3</span>
 <span class="n">is_defined</span><span class="o">/</span><span class="mi">2</span>     <span class="p">|</span> <span class="n">is_defined</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">is_empty</span><span class="o">/</span><span class="mi">1</span>       <span class="p">|</span> <span class="n">is_empty</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">iterator</span><span class="o">/</span><span class="mi">1</span>       <span class="p">|</span> <span class="n">iterator</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">iterator_from</span><span class="o">/</span><span class="mi">2</span>  <span class="p">|</span> <span class="n">iterator_from</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">keys</span><span class="o">/</span><span class="mi">1</span>           <span class="p">|</span> <span class="n">keys</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">largest</span><span class="o">/</span><span class="mi">1</span>        <span class="p">|</span> <span class="n">largest</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">lookup</span><span class="o">/</span><span class="mi">2</span>         <span class="p">|</span> <span class="n">lookup</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">map</span><span class="o">/</span><span class="mi">2</span>            <span class="p">|</span> <span class="n">map</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">next</span><span class="o">/</span><span class="mi">1</span>           <span class="p">|</span> <span class="n">next</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">set_parameter</span><span class="o">/</span><span class="mi">3</span>  <span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">size_key_values</span><span class="o">/</span><span class="mi">1</span><span class="p">|</span> <span class="nb">size</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">size_nodes</span><span class="o">/</span><span class="mi">1</span>     <span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">smallest</span><span class="o">/</span><span class="mi">1</span>       <span class="p">|</span> <span class="n">smallest</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">sort_ascending</span><span class="o">/</span><span class="mi">2</span> <span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">sort_descending</span><span class="o">/</span><span class="mi">2</span><span class="p">|</span> <span class="n">n</span><span class="o">/</span><span class="n">a</span>
 <span class="n">take</span><span class="o">/</span><span class="mi">2</span>           <span class="p">|</span> <span class="n">take</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">take_any</span><span class="o">/</span><span class="mi">2</span>       <span class="p">|</span> <span class="n">take_any</span><span class="o">/</span><span class="mi">2</span>
 <span class="n">take_largest</span><span class="o">/</span><span class="mi">1</span>   <span class="p">|</span> <span class="n">take_largest</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">take_smallest</span><span class="o">/</span><span class="mi">1</span>  <span class="p">|</span> <span class="n">take_smallest</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">to_list</span><span class="o">/</span><span class="mi">1</span>        <span class="p">|</span> <span class="n">to_list</span><span class="o">/</span><span class="mi">1</span>
 <span class="n">update</span><span class="o">/</span><span class="mi">3</span>         <span class="p">|</span> <span class="n">update</span><span class="o">/</span><span class="mi">3</span>
 <span class="n">values</span><span class="o">/</span><span class="mi">1</span>         <span class="p">|</span> <span class="n">values</span><span class="o">/</span><span class="mi">1</span>
</code></pre></div></div>
<p>The functions <code>delete/2</code> and <code>insert/3</code> are implementations of the algorithms
of Cormen, Thomas; Leiserson, Charles; Rivest, Ronald; Stein, Clifford (2009),
Introduction to Algorithms (Third ed.), MIT Press and McGraw-Hill, pp. 484-504,
ISBN 0-262-03384-4. Chapter 18: B-Trees.</p>
      <h1  id="backwards-compatibility">
        
        
          Backwards Compatibility <a href="#backwards-compatibility">#</a>
        
        
      </h1>
    
<p>No issues - except module name collisions.</p>
      <h1  id="reference-implementation">
        
        
          Reference Implementation <a href="#reference-implementation">#</a>
        
        
      </h1>
    
<p>The reference implementation can be fetched from Github:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code data-lang="erlang"><span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">walter</span><span class="o">-</span><span class="n">weinmann</span><span class="o">/</span><span class="n">b_trees</span>
</code></pre></div></div>

            </div>
        </div>
    </div>
</div>
<script src="/assets/js/prismjs/prism.js"></script>
<script src="/assets/js/prismjs/components/prism-erlang.js"></script>
    <footer class="container-fluid footer text-center border-top border-bottom">
        <div>
            <a href="/downloads.html" title="DOWNLOAD"><img src="/assets/img/download.png" alt="Download Erlang/OTP"></a>
        </div>
        <div>
            <a href="http://www.github.com/erlang/otp"><img
                    src="/assets/img/GitHub-Mark-32px.png" alt="Erlang/OTP on Github"></a>
        </div>
        
        <div>
            <a href="http://www.twitter.com/erlang_org"><img src="/assets/img/twitter.png"
                    width="32" alt="Erlang/OTP twitter"></a>
        </div>
    </footer>
    <script src="/assets/js/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>